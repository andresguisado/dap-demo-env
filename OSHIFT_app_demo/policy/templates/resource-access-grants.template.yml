---
# Grant application layers access to secrets
- !permit
  privileges: [ read, execute ]
  roles:
  - !layer {{ TEST_APP_NAMESPACE_NAME }}/webservers
  resources:
  - !variable k8s-secrets/app-username
  - !variable k8s-secrets/app-apikey

- !permit
  privileges: [ read, execute ]
  roles:
  - !layer {{ TEST_APP_NAMESPACE_NAME }}/appservers
  resources:
  - !variable k8s-secrets/db-username
  - !variable k8s-secrets/db-password

- !grant
  role: !group DemoVault/CICD/CICD_Secrets/delegation/consumers
  member: !layer {{ TEST_APP_NAMESPACE_NAME }}/appservers
