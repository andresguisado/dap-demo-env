version: "2"
services:
  postgres-db:
    protocol: pg
    listenOn: tcp://0.0.0.0:5432
    credentials:
      address:
        from: conjur
        get: test-app-secretless-db/pg-address
      username:
        from: conjur
        get: test-app-secretless-db/pg-username
      password:
        from: conjur
        get: test-app-secretless-db/pg-password
      sslmode:
        from: conjur
        get: test-app-secretless-db/pg-sslmode

  mysql-db:
    protocol: mysql
    listenOn: tcp://0.0.0.0:3306
    credentials:
      host:
        from: conjur
        get: test-app-secretless-db/mysql-host
      port:
        from: conjur
        get: test-app-secretless-db/mysql-port
      username:
        from: conjur
        get: test-app-secretless-db/mysql-username
      password:
        from: conjur
        get: test-app-secretless-db/mysql-password
      sslmode:
        from: conjur
        get: test-app-secretless-db/mysql-sslmode

  ssh:
    protocol: ssh
    listenOn: tcp://0.0.0.0:2222
    credentials:
      address: 192.168.99.100
      user: docker
      privateKey:
        from: conjur
        get: DemoVault/CICD/CICD_Secrets/SSH-minikube/password
